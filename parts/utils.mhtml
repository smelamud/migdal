<< @(#) $Id$ >>
<?php
function elementEdit($title,$value,$name,$size,$length) #COMPATIBILITY
{
return "<tr>
         <td>$title </td>
         <td><input type=text name='$name' value='$value' size=$size
	            maxlength=$length></td>
	</tr>";
}

function condEdit($title,$edit,$value,$name,$size,$length)
{
return !$edit ?
       $value!='' ? "<tr><td><b>$title:</b></td><td>$value</td></tr>" : '' :
       elementEdit($title,$value,$name,$size,$length);
}

function condEditStatus($title,$edit,$status,$value,$name,$size,$length)
{
return !$edit ?
       $value!='' ? "<tr>
                      <td><b>$title:</b></td><td>$status&nbsp;$value</td>
		     </tr>"
                  : '' :
       "<tr>
         <td>$title </td>
	 <td>$status&nbsp;<input type=text name='$name' value='$value'
	                         size=$size maxlength=$length></td>
	</tr>";
}

function condEditValue($title,$edit,$value,$valueEdit,$name,$size,$length)
{
return !$edit ?
       $value!='' ? "<tr><td><b>$title:</b></td><td>$value</td></tr>" : '' :
       elementEdit($title,$valueEdit,$name,$size,$length);
}

function elementCheckBox($name,$value,$title,$span=1) #COMPATIBILITY
{
return "<tr><td colspan=$span>
         <input type=checkbox name=$name value=1 ".($value ? 'checked' : '')
                                                 ."> $title
	</td></tr>";
}

function condCheckBox($edit,$name,$value,$title,$textOn='',$textOff='',$span=1)
{
return !$edit ? "<tr><td colspan=$span>
                  <i>".($value ? $textOn : $textOff).'</i>
                 </td></tr>'
              : elementCheckBox($name,$value,$title,$span);
}

function elementOption($label,$value,$peervalue) #COMPATIBILITY
{
return "<option label='$label' value=$value".
       ($value==$peervalue ? ' selected ' : '').
       '>';
}
?>

<element name='error'>
<if what='$$err==$id'>
 <tr><tdspan span=$span>
  <a name='error'>
  <font color='$color'>$text</font>
 </tdspan></tr>
</if>
</element>

<element name='SenderLink'>
$message.LoginLink
<if what='$message.isSenderVisible'>
 (<a href='useredit.php?editid=$message.SenderId&redir=$_'>подробнее</a>)
</if>
</element>

<?php
function perror($code,$message,$color='red',$span=1) #COMPATIBILITY
{
displayError($code,$message,$color,$span);
}

function navigator($list)
{
global $REQUEST_URI;

$prev=$list->getOffset()-$list->getLimit();
$prev=$prev<0 ? 0 : $prev;
$next=$list->getOffset()+$list->getLimit();
$prevURI=remakeURI($REQUEST_URI,
                   array(),
		   array('offset' => $prev));
$nextURI=remakeURI($REQUEST_URI,
                   array(),
		   array('offset' => $next));
return "<br><table width=100%><tr>
         <td align=left width=30%>
	  <a href=$prevURI>".
	  ($list->getOffset()!=0 ? '<-- Предыдущие' : '').
	 '</a>
	 </td>
	 <td align=center width=40%>'.
	 ($list->getSize()<=$list->getLimit() ? 'Всего: '.$list->getSize() :
	 '['.($list->getOffset()+1).'-'.
	     ($list->getOffset()+$list->getCount()).'] из '.$list->getSize()).
        "</td>
	 <td align=right width=30%>
	  <a href=$nextURI>".
	  ($list->getOffset()+$list->getCount()<$list->getSize()
	   ? 'Следующие -->' : '').
	 '</a>
	 </td>
	</tr></table><br>';
}

function batcher($current,$var)
{
global $SCRIPT_NAME,$HTTP_GET_VARS;

$s="<table width=100%>
     <form method=get action='$SCRIPT_NAME'>";
foreach($HTTP_GET_VARS as $key => $value)
       if($key!='mp')
         $s.="<input type=hidden name='$key' value='$value'>";
$s.=" <tr><td align=right><table><tr valign=center>
      <td>Показывать по&nbsp;</td>
      <td><select name='$var'>";
$shows=array(10,15,20,25,30,35,40);
$shows[]=$current;
sort($shows);
$shows=array_unique($shows);
foreach($shows as $val)
       $s.="<option label=$val value=$val ".
                               ($val==$current ? 'selected' : '').
	   ' >';
return "$s
      </select></td>
      <td>сообщений&nbsp;</td>
      <td><input type=submit value='Изменить'></td>
      </tr></table></td></tr>
     </form>
    </table><br>";
}
?>
