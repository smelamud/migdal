# Makefile for Migdal website (parts/ directory)

# @(#) $Id$

targetdir=$(builddir)/www/parts/

OBJECTS = article.mhtml backtrace.mhtml bannerbank.mhtml banners.mhtml \
	  book-chapters.mhtml book-chapters-static.mhtml book-ring.mhtml \
	  book-ring-static.mhtml bottom.mhtml catalog.mhtml complain.mhtml \
	  complainactionselect.mhtml daily-announce.mhtml daily-picture.mhtml \
	  discussions.mhtml ears.mhtml events.mhtml failpage.mhtml \
	  formutils.mhtml forum.mhtml forums.mhtml gallery.mhtml \
	  gallery-main.mhtml googleru.mhtml grpselect.mhtml hannukah.mhtml \
	  help-link.mhtml history.mhtml hit-parade.mhtml hotlog.mhtml \
	  jewishru.mhtml langselect.mhtml links-switcher.mhtml login.mhtml \
	  mailru.mhtml menu.mhtml migdal-news.mhtml peruser.mhtml \
	  peruser-intros.mhtml picture.mhtml picture-main.mhtml pointer.mhtml \
	  posting.mhtml posting-book.mhtml posting-ear.mhtml \
	  posting-general.mhtml posting-link.mhtml posting-peruser.mhtml \
	  posting-printing.mhtml posting-textear.mhtml posting-times.mhtml \
	  posting-times-cover.mhtml posting-tip.mhtml postings.mhtml \
	  postings-links.mhtml postings-migdal-news.mhtml rabbi.mhtml \
	  rambler.mhtml relogin.mhtml seealso.mhtml spin.mhtml subtitle.mhtml \
	  textears.mhtml tip.mhtml today.mhtml top.mhtml top-404.mhtml \
	  topics.mhtml topics-admin.mhtml topics-book.mhtml topics-daily.mhtml \
	  topics-events.mhtml topics-gallery-general.mhtml \
	  topics-gallery-major.mhtml topics-gallery-migdal.mhtml \
	  topics-gallery-peruser.mhtml topics-general.mhtml topics-links.mhtml \
	  topics-major.mhtml topics-migdal.mhtml topics-migdal-english.mhtml \
	  topics-peruser.mhtml topics-times.mhtml topicselect.mhtml \
	  tzdaka.mhtml uploader.mhtml userinfo.mhtml utils.mhtml vote.mhtml \
	  xml-text.mhtml
	  
$(targetdir)/.stamp:
	-mkdir -p $(targetdir)
	touch $@

$(targetdir)/.htaccess: $(targetdir)/.stamp .htaccess
	cp .htaccess $(targetdir)

$(targetdir)/%.php: %.mhtml $(targetdir)/.stamp ../../miparser \
		../../macros.mhtml ../macros.mhtml
	../../miparser -M ../../macros.mhtml -M ../macros.mhtml $< > $@

all: $(targetdir)/.htaccess $(OBJECTS:%.mhtml=$(targetdir)/%.php) ;

Makefile: Makefile.in ../../conf/migdal.conf
	../../confmake $^ $(builddir) > Makefile
