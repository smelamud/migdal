<< @(#) $Id$ >>

<element name='batcher' params='list,topic_id,noguests,noadd'>
<table width=100%>
 <tr valign=bottom>
  <if what='!$noadd'>
   <td align=left class='info'>
    <table><tr valign=center>
     <td><image src='/pics/sheet.gif'></td>
     <td>
      <catalog name='catalog' id='$topic_id'>
      <a href='/gallery/${catalog}add/?noguests=$noguests&redirid=$_'
	 >Добавить картинку</a>
     </td>
    </tr></table>
   </td>
  </if>
  <td align=center><spin list='$list'></td>
  <td align=right class='eightpt'>
   <b>Сортировать</b>
   <navi_sort title='по дате' value='*SORT_PSENT'>|
   <navi_sort title='по рейтингу' value='*SORT_RATING'>
  </td>
 </tr>
</table>
</element>

<element name='gallery'>
<assign name='limit' value!='$rows * $cols'>
<iterate_postinglist name='list' grp='*GRP_GRAPHICS' topic_id='$topic_id'
                     limit=0 sort='$sort' subdomain='$subdomain'
                     user='$user_id'>
<iterate_rows cols='$cols'>
<pager_new name='pager' size='$list.Size' limit='$limit' offset='$offset'>
<batcher list='$pager' topic_id='$topic_id' noguests='$noguests' noadd='$noadd'>
<ifnzero what='$list.Count'>
 <div style='display: none'>
  <for>
   <if what='$list.Position == $offset'>
    </div>
    <div class='pictures'>
   </if>
   <if what='$list.Position == $offset + $limit'>
    </div>
    <div style='display: none'>
   </if>
   <assign name='hollow'
           value!='$list.Position < $offset
                   || $list.Position >= $offset + $limit'>
   <picture picture='$.' showtopic!='$topic_id<0' showdiscuss='*true'
            rel#='gallery-$topic_id' list_index!='$list.Position + 1'
            list_size='$list.Size' hollow='$hollow'>
   <if what='$;isEol'>
    <br/>
   </if>
  </for>
 </div>
 <batcher list='$pager' topic_id='$topic_id' noguests='$noguests' noadd='$noadd'>
</ifnzero>
</element>
