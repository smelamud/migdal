<< @(#) $Id$ >>

<int name='postid'>
<int name='par'>
<int name='x'>
<int name='y'>

<int name='edittag'>
<int name='editid'>
<int name='placement'>
<int name='append'>
<int name='small_image'>
<int name='small_image_x'>
<int name='small_image_y'>
<string name='small_image_format'>
<int name='large_image'>
<int name='large_image_x'>
<int name='large_image_y'>
<int name='large_image_size'>
<string name='large_image_format'>
<string name='large_image_filename'>
<string name='title'>

<element name=place params='value'>
<radio_button name='placement' value='$value'
              checked!='$$inner.Placement==$value'>
</element>

<html>
<preamble>
<body>
 <top ident='index'>
 <posting_obj id='$postid'>
 <form_table title#='Вставка картинки в статью "$=,Subject"'>
  <form method=post enctype='multipart/form-data'
	action='/actions/posting/image/modify'>
   <hidden name='edittag' value=1>
   <hidden name='okdir' value='$,GrpDetailsHref'>
   <hidden name='faildir' value='$-'>
   <hidden name='postid' value='$postid'>
   <hidden name='insert' value='1'>
   <starinfo>
   <inner_image_par name='inner' entry_id='$postid' par='$par' x='$x' y='$y'>
   <setup>
   <form_section title='Выбрать из списка'>
   <error id='*ELIM_POSTING_WRITE' text='Вы не можете вставлять картинки в это сообщение'>
   <iterate_images postid='$postid'>
   <form_select title='Выбрать картинку' name='editid'>
    <form_option title='-- Пусто --' value='0' selected!='$,ImageId==0'>
    <for>
     <ife what='$.Title'>
      <assign name='name' value='$.LargeImageFilename'>
     <else>
      <assign name='name' value='$.TitlePea'>
      <if what='!$.isTitlePea'>
       <assign name='name' value#='$name...'>
      </if>
     </if>
     <assign name='name' value#='$name (${.SmallImageX}x${.SmallImageY})'>
     <if what='$.isInserted'>
      <assign name='name' value#='(+) $name'>
     </if>
     <form_option title='$name' value='$.Id' selected!='$,ImageId==$.Id'>
    </for>
   </form_select>
   <image_obj id='$editid'>
   <setup>
   <form_section title='Загрузить из файла'>
   <form_select title='Заменить картинку из списка' name='append' style='box'>
    <form_option title='Добавить картинку из файла к списку' value='1'
                 selected!='$append!=0'>
    <form_option title='Заменить выбранную картинку из списка на картинку
                        из файла' value='0' selected!='$append==0'>
   </form_select>
   <error id='*ELIM_NO_EDIT' text='Вы не можете редактировать эту картинку'>
   <error id='*ELIM_NO_POSTING' text='Вышестоящего сообщения не существует'>
   <error id='*ELIM_POSTING_APPEND' text='Вы не можете редактировать этот список'>
   <error id='*ELIM_IMAGE_ABSENT' text='Картинка не указана'>
   <error id='*EIU_UNKNOWN_IMAGE' text='Неизвестный формат картинки'>
   <error id='*EIU_IMAGE_LARGE' text='Картинка слишком велика (больше 2M)'>
   <error id='*EIU_UNKNOWN_THUMBNAIL'
	  text='Формат маленькой картинки, указанный при конфигурации сервера,
		не поддерживается'>
   <error id='*EIU_INTERNAL_ERROR' text='Не удалось загрузить картинку'>
   <error id='*EVH_NO_PARENT' text='Такой темы не существует'>
   <error id='*EVH_NO_UP' text='Вышестоящего сообщения не существует'>
   <error id='*EVH_LOOP' text='Сообщение не может быть подчиненным себе'>
   <error id='*EVH_NOT_UP_UNDER_PARENT'
	  text='Тема вышестоящего сообщения должна совпадать с этой темой'>
   <error id='*EVH_INCORRECT' text='Нарушение иерархии объектов'>
   <if what='$,hasSmallImage'>
    <assign name='loaded' value#='Загружен файл $=,LargeImageFilename
				  (${,LargeImageSizeKB}K)'>
   <else>
    <assign name='loaded' value=''>
   </if>
   <assign name='small_url' value!="$,hasLargeImage ? $,SmallImageURL : ''">
   <assign name='large_url' value="$,LargeImageURL">
   <form_uploader title='Изображение' name='image_file'
                  loaded='$loaded' delname='del_image'
		  small_url='$small_url' large_url='$large_url'>
   <form_checkbox title='Вставлять в уменьшенном виде' name='has_large_image'
		  checked='$,hasLargeImage' style='radio' id_yes='hlm-yes'>
   <form_line title='Размер'>
    <edit name='small_image_x' value='$,SmallImageX' size=4 maxlength=4
          onkeypress='$("#hlm-yes").attr("checked", true)'>
    x
    <edit name='small_image_y' value='$,SmallImageY' size=4 maxlength=4
          onkeypress='$("#hlm-yes").attr("checked", true)'>
   </form_line>
   <hidden name='small_image' value='$,SmallImage'>
   <hidden name='small_image_format' value='$,SmallImageFormat'>
   <hidden name='large_image' value='$,LargeImage'>
   <hidden name='large_image_x' value='$,LargeImageX'>
   <hidden name='large_image_y' value='$,LargeImageY'>
   <hidden name='large_image_size' value='$,LargeImageSize'>
   <hidden name='large_image_format' value='$,LargeImageFormat'>
   <hidden name='large_image_filename' value='$,LargeImageFilename'>
   <form_editor title='Подпись' name='title' body='$=,Title' rows=3>
   <form_section title='Размещение'>
   <hidden name='par' value='$par'>
   <hidden name='x' value='$x'>
   <hidden name='y' value='$y'>
   <form_line title='Размещение картинки относительно текста'>
    <table>
     <tr>
      <td align=center><place value='*IPL_CENTERLEFT'></td>
      <td align=center><place value='*IPL_CENTER'></td>
      <td align=center><place value='*IPL_CENTERRIGHT'></td>
     </tr>
     <tr>
      <td align=center><place value='*IPL_BOTTOMLEFT'></td>
      <td align=center><i>Текст</i></td>
      <td align=center><place value='*IPL_BOTTOMRIGHT'></td>
     </tr>
    </table>
   </form_line>
   <form_buttons title='Вставить'>
  </form>
 </form_table>
 <bottom>
</body>
</html>
