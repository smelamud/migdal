# Makefile for moshiach.ru website

# @(#) $Id$
# Based-on: migdal/Makefile.in 1.28

OBJECTS = admin.php article-admin.php articles.php limedit.php liminsert.php \
	photos.php postingedit.php qanda.php quotes.php topicedit.php \
	topicorg.php

%.php: %.mhtml ../miparser ../macros.mhtml macros.mhtml
	../miparser -M ../macros.mhtml -M macros.mhtml $< > $@

all: $(OBJECTS)
	(cd grp; $(MAKE) all)
	(cd parts; $(MAKE) all)
	(cd styles; $(MAKE) all)
	(cd mailings; $(MAKE) all)

Makefile: Makefile.in ../conf/migdal.conf
	../confmake $^ > Makefile

dbinfo:
	mysqldump -u $(dbUser) --password=$(dbPassword) $(dbName) \
		ratings --no-create-info > migdal.db

clean:
	-rm $(OBJECTS)
	(cd grp; $(MAKE) clean)
	(cd parts; $(MAKE) clean)
	(cd styles; $(MAKE) clean)
	(cd mailings; $(MAKE) clean)
