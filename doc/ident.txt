			    Система идентификации
			    =====================

(Символические обозначения числовых меток, о которых здесь пойдет речь, в
языках программирования называются идентификаторами. Но, поскольку термином
"идентификатор" в базах данных обычно называют уникальное числовое поле, мы
будем называть их "обозначениями".)

Когда вам необходимо сослаться на статью, сообщение, тему или что-либо другое
при помощи URL, то очень неудобно указывать в нем числовой идентификатор. Для
начала этот идентификатор нужно узнать, поскольку он проставляется СУБД
автоматически (а значит сообщение уже должно быть внесено в базу), а если он
по какой-то причине изменится, то за соответствие вашего URL'а действительности
никто не отвечает.

Именно поэтому во многих местах в ядре можно указывать вместо числового
идентификатора символьное обозначение, которое вводится пользователем
(желательно администратором) при создании объекта. Оно вполне может заменить
многим администраторам имя файла, которое так удобно было использовать в
ссылках при редактировании файла вручную.

Максимальная длина обозначения - 15 символов. Обозначение не должно начинаться
с цифры.

По соглашению, поле таблицы, в котором хранится обозначение, называется во всех
таблицах одинаково - ident. Для работы с обозначениями можно использовать
следующие функции (lib/ident.php):

function byIdent($id,$byId='id',$byIdent='ident');

Возвращает "$byId=$id", если $id - число и "$byIdent='$id'" в противном
случае. Эта функция предназначена для использования там, где конструируются
SQL-запросы. Если функция, например, getTopicById() принимает в качестве
параметра идентификатор темы, то можно вместо

"select * from topics where id=$id"

написать

"select * from topics where ".byIdent($id)

и функция уже сможет работать не только с числовыми идентификаторами, но и с
символьными обозначениями, и при этом не нужно будет заводить еще один
параметр. Аналогично все функции, итераторы, скрипты и Web-страницы, которые
могут принимать обозначения в качестве параметра, примают его через тот же
параметр, что и обычный числовой идентификатор.

Предупреждение: Далеко не все функции ядра могут работать как с
идентификаторами, так и с обозначениями. Поэтому, если Web-страница принимает
в качестве параметра обозначение, но его следует использовать только в тех
функциях и итераторах, которые гарантированно с ними работают, а остальным
передавать уже идентификатор.

function byIdentRecursive($table,$id,$recursive,$byId='id',
                          $byIdent='ident',$byTrack='track');

Эта функция совпадает с byIdent(), если $recursive==false. Если
$recursive==true, она извлекает идентификатор, соответствующий обозначению,
при помощи idByIdent(), и формирует like-запрос для поиска элемента со всеми
его потомками в древовидной структуре [NWD]. Таким образом, запрос

"select * from topics where ".byIdentRecursive('topics',$id,true)

вернет указанный элемент со всеми потомками, причем $id может быть как
идентификатором, так и обозначением.

function idByIdent($table,$ident);

Эта функция выбирает из указанной таблицы идентификатор, соответствующий
обозначению $ident. Если $ident - число, то эта функция возвращает $ident.

Based-on: migdal.db 1.49 (ограничения на длину обозначения)
Based-on: lib/ident.php 1.10

$Id$
