# MySQL dump 8.14
#
# Host: localhost    Database: migdal
#--------------------------------------------------------
# Server version	3.23.41-log

#
# Table structure for table 'chat_messages'
#

CREATE TABLE chat_messages (
  id int(11) NOT NULL auto_increment,
  sender_id int(11) NOT NULL default '0',
  private_id int(11) NOT NULL default '0',
  sent timestamp(14) NOT NULL,
  text varchar(250) NOT NULL default '',
  PRIMARY KEY  (id),
  KEY sender_id (sender_id),
  KEY sent (sent)
) TYPE=MyISAM;

#
# Table structure for table 'choices'
#

CREATE TABLE choices (
  id int(11) NOT NULL auto_increment,
  message_id int(11) NOT NULL default '0',
  choice_index tinyint(4) NOT NULL default '0',
  name varchar(70) NOT NULL default '',
  votes int(11) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY message_id (message_id)
) TYPE=MyISAM;

#
# Table structure for table 'complain_actions'
#

CREATE TABLE complain_actions (
  id int(11) NOT NULL auto_increment,
  type_id int(11) NOT NULL default '0',
  opcode smallint(6) NOT NULL default '0',
  name varchar(70) NOT NULL default '',
  text text NOT NULL,
  automatic tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY type_id (type_id)
) TYPE=MyISAM;

#
# Table structure for table 'complain_statements'
#

CREATE TABLE complain_statements (
  id int(11) NOT NULL auto_increment,
  opcode smallint(6) NOT NULL default '0',
  sql text NOT NULL,
  sql_index tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY action_id (opcode),
  KEY sql_index (sql_index)
) TYPE=MyISAM;

#
# Table structure for table 'complain_types'
#

CREATE TABLE complain_types (
  id int(11) NOT NULL auto_increment,
  ident varchar(15) NOT NULL default '',
  assign varchar(16) NOT NULL default '',
  deadline smallint(6) NOT NULL default '0',
  display varchar(70) NOT NULL default '',
  PRIMARY KEY  (id),
  UNIQUE KEY ident (ident)
) TYPE=MyISAM;

#
# Table structure for table 'complains'
#

CREATE TABLE complains (
  id int(11) NOT NULL auto_increment,
  recipient_id int(11) NOT NULL default '0',
  message_id int(11) NOT NULL default '0',
  type_id int(11) NOT NULL default '0',
  link int(11) NOT NULL default '0',
  closed datetime default NULL,
  PRIMARY KEY  (id),
  KEY id (id),
  KEY recipient_id (recipient_id),
  KEY message_id (message_id),
  KEY type_id (type_id)
) TYPE=MyISAM;

#
# Table structure for table 'forums'
#

CREATE TABLE forums (
  id int(11) NOT NULL auto_increment,
  message_id int(11) NOT NULL default '0',
  up int(11) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY message_id (message_id),
  KEY up (up)
) TYPE=MyISAM;

#
# Table structure for table 'images'
#

CREATE TABLE images (
  id int(11) NOT NULL auto_increment,
  image_set int(11) NOT NULL default '0',
  filename varchar(70) NOT NULL default '',
  small mediumblob NOT NULL,
  small_x smallint(6) NOT NULL default '0',
  small_y smallint(6) NOT NULL default '0',
  large mediumblob NOT NULL,
  large_x smallint(6) NOT NULL default '0',
  large_y smallint(6) NOT NULL default '0',
  format varchar(30) NOT NULL default '',
  PRIMARY KEY  (id),
  KEY image_set (image_set)
) TYPE=MyISAM;

#
# Table structure for table 'mailing_types'
#

CREATE TABLE mailing_types (
  id int(11) NOT NULL auto_increment,
  ident char(70) NOT NULL default '',
  text char(70) NOT NULL default '',
  PRIMARY KEY  (id),
  UNIQUE KEY ident (ident)
) TYPE=MyISAM;

#
# Table structure for table 'mailings'
#

CREATE TABLE mailings (
  id int(11) NOT NULL auto_increment,
  type_id int(11) NOT NULL default '0',
  link int(11) NOT NULL default '0',
  receiver_id int(11) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY type_id (type_id),
  KEY receiver_id (receiver_id)
) TYPE=MyISAM;

#
# Table structure for table 'menu'
#

CREATE TABLE menu (
  id int(11) NOT NULL auto_increment,
  name varchar(30) NOT NULL default '',
  ident varchar(15) NOT NULL default '',
  link varchar(70) NOT NULL default '',
  hidden tinyint(4) NOT NULL default '0',
  menu_index tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (id),
  UNIQUE KEY ident (ident),
  KEY menu_index (menu_index)
) TYPE=MyISAM;

#
# Table structure for table 'messages'
#

CREATE TABLE messages (
  id int(11) NOT NULL auto_increment,
  body mediumtext NOT NULL,
  subject varchar(250) NOT NULL default '',
  sender_id int(11) NOT NULL default '0',
  image_set int(11) NOT NULL default '0',
  hidden tinyint(4) NOT NULL default '0',
  disabled tinyint(4) NOT NULL default '0',
  sent datetime NOT NULL default '0000-00-00 00:00:00',
  PRIMARY KEY  (id),
  KEY sender_id (sender_id),
  KEY image_set (image_set)
) TYPE=MyISAM;

#
# Table structure for table 'postings'
#

CREATE TABLE postings (
  id int(11) NOT NULL auto_increment,
  message_id int(11) NOT NULL default '0',
  topic_id int(11) NOT NULL default '0',
  personal_id int(11) NOT NULL default '0',
  grp tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY message_id (message_id),
  KEY topic_id (topic_id),
  KEY personal_id (personal_id),
  KEY grp (grp)
) TYPE=MyISAM;

#
# Table structure for table 'sessions'
#

CREATE TABLE sessions (
  id int(11) NOT NULL auto_increment,
  user_id int(11) NOT NULL default '0',
  last timestamp(14) NOT NULL,
  sid int(11) NOT NULL default '0',
  PRIMARY KEY  (id),
  KEY user_id (user_id),
  KEY sid (sid),
  KEY last (last),
  KEY last_2 (last)
) TYPE=MyISAM;

#
# Table structure for table 'statistics'
#

CREATE TABLE statistics (
  logins int(11) NOT NULL default '0'
) TYPE=MyISAM;

#
# Table structure for table 'tmp_texts'
#

CREATE TABLE tmp_texts (
  id int(11) NOT NULL auto_increment,
  value mediumtext NOT NULL,
  last_access timestamp(14) NOT NULL,
  PRIMARY KEY  (id)
) TYPE=MyISAM;

#
# Table structure for table 'topics'
#

CREATE TABLE topics (
  id int(11) NOT NULL auto_increment,
  name varchar(70) NOT NULL default '',
  description varchar(250) NOT NULL default '',
  hidden tinyint(4) NOT NULL default '0',
  no_news tinyint(4) NOT NULL default '0',
  no_forums tinyint(4) NOT NULL default '0',
  no_gallery tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (id)
) TYPE=MyISAM;

#
# Table structure for table 'users'
#

CREATE TABLE users (
  id int(11) NOT NULL auto_increment,
  login varchar(30) NOT NULL default '',
  password varchar(40) NOT NULL default '',
  name varchar(30) NOT NULL default '',
  jewish_name varchar(30) NOT NULL default '',
  surname varchar(30) NOT NULL default '',
  gender enum('mine','femine') NOT NULL default 'mine',
  info text NOT NULL,
  birthday date NOT NULL default '0000-00-00',
  migdal_student tinyint(4) NOT NULL default '0',
  last_online datetime NOT NULL default '0000-00-00 00:00:00',
  confirm_deadline datetime default NULL,
  confirm_code varchar(20) NOT NULL default '',
  email varchar(70) NOT NULL default '',
  hide_email tinyint(4) NOT NULL default '0',
  icq varchar(15) NOT NULL default '',
  email_disabled tinyint(4) NOT NULL default '0',
  accepts_complains tinyint(4) NOT NULL default '0',
  rebe tinyint(4) NOT NULL default '0',
  admin_users tinyint(4) NOT NULL default '0',
  admin_topics tinyint(4) NOT NULL default '0',
  admin_menu tinyint(4) NOT NULL default '0',
  moderator tinyint(4) NOT NULL default '0',
  judge tinyint(4) NOT NULL default '0',
  hidden tinyint(4) NOT NULL default '0',
  no_login tinyint(4) NOT NULL default '0',
  has_personal tinyint(4) NOT NULL default '0',
  msg_portion tinyint(4) NOT NULL default '10',
  forum_portion tinyint(4) NOT NULL default '10',
  complain_portion tinyint(4) NOT NULL default '20',
  chat_portion tinyint(4) NOT NULL default '20',
  chat_refresh tinyint(4) NOT NULL default '10',
  PRIMARY KEY  (id),
  KEY login (login),
  KEY password (password),
  KEY confirm_deadline (confirm_deadline),
  KEY confirm_code (confirm_code),
  KEY confirm_deadline_2 (confirm_deadline)
) TYPE=MyISAM;

# MySQL dump 8.14
#
# Host: localhost    Database: migdal
#--------------------------------------------------------
# Server version	3.23.41-log

#
# Dumping data for table 'menu'
#

INSERT INTO menu VALUES (1,'Главная','index','index.php',0,0);
INSERT INTO menu VALUES (2,'Пользователи','users','users.php',0,5);
INSERT INTO menu VALUES (3,'Форумы','forums','topics.php?grp=1',0,2);
INSERT INTO menu VALUES (4,'Галерея','gallery','topics.php?grp=4',0,3);
INSERT INTO menu VALUES (5,'Новости','news','topics.php?grp=2',0,1);
INSERT INTO menu VALUES (6,'Жалобная книга','complains','complains.php',0,6);
INSERT INTO menu VALUES (7,'Чат','chat','chat.php',0,4);

#
# Dumping data for table 'complain_types'
#

INSERT INTO complain_types VALUES (1,'normal','',0,'parts/cs_normal.php');
INSERT INTO complain_types VALUES (2,'forum','moderator',0,'parts/cs_forum.php');

#
# Dumping data for table 'complain_statements'
#

INSERT INTO complain_statements VALUES (1,1,'update complains set closed=now() where id=%complain_id',0);

#
# Dumping data for table 'mailing_types'
#

INSERT INTO mailing_types VALUES (1,'register','mailings/register.mail');

