<< @(#) $Id$ >>

<ident name='up'>

<element name='hd' params='item'>
 <ifne what='$item.Ident'>
  <assign name='info' value#='[$=item.Ident=$item.Id]'>
 <else>
  <assign name='info' value#='[$item.Id]'>
 </ifne>
 <a href='/admin/topics/$item.TrackPath' title='$=item.BodyNormal'><asp>
  $=item.Subject</a>&sp;$info&sp;
 <br>$item.Catalog
</element>

<element name='branch' params='up,up_path,append,write,root'
         defaults="root='*false'">
 <iterate_topiclist grp='*GRP_ALL' up='$up'>
 <if what='$up!=0 && ($append || $write)'>
  <br>
 </if>
 <if what='$append'>
  <a href='/admin/topics/${up_path}add/?redirid=$_' class='edit'>Добавить</a>
 </if>
 <if what='$up!=0 && $write'>
  <a href='/admin/topics/${up_path}edit/?redirid=$_' class='edit'>Изменить</a>
  <a href='/admin/topics/${up_path}delete/?redirid=$_' class='edit'>Удалить</a>
  <a href='/admin/topics/${up_path}chmod/?redirid=$_' class='edit'>Права</a>
  <a href='/admin/topics/${up_path}reorder/?redirid=$_'
     class='edit'>Расставить</a>
 </if>
 <ifnzero what='$;Count'>
  <ul class='topics'>
   <for>
    <li><hd item='$.'><br>
    <tt>$.PermString&nbsp;$=.Login:$=.GroupLogin</tt>
    <branch up='$.Id' up_path='$.TrackPath' append='$.isAppendable'
            write='$.isWritable'>
   </for>
  </ul>
 </ifnzero>
</element>

<html>
 <preamble>

 <top ident='index'>
 <table width=100% cellpadding=5>
  <tr valign=top>
   <td width=150 class='eframe'>
    <topics>
   </td>
   <td class='cframe'>
    <subtitle>
    <div class='topics ninept' style='padding: 0px'>
     <ifnzero what='$up'>
      <topic_full_name name='full_name' id='$up'>
      <topic_obj id='$up'>
      <table><tr>
       <td width=20><image src='/pics/up-level.gif'></td>
       <td>
        <a href='/admin/topics/$,ParentTrackPath'
           class='ninept'>На уровень вверх</a>
       </td>
      </tr></table>
      <br>
      <a href='/admin/topics/'>Все темы</a>
      <iterate_topic_hierarchy name='hier' topic_id='$up'>
      <for>
       :: <a href='/admin/topics/$.TrackPath'>$=.Subject</a>
       <islast what='$hier'>
        <ifne what='$.Ident'>
         <assign name='info' value#='[$=.Ident=$.Id]'>
        <else>
         <assign name='info' value#='[$.Id]'>
        </ifne>
       </islast>
       &sp;$info
      </for>
      <assign name='up_path' value='$,TrackPath'>
     <else>
      <assign name='up_path' value=''>
     </ifnzero>
     <branch up='$up' up_path='$up_path' append='$userAdminTopics'
             write='$userAdminTopics' root='*true'>
    </div>
   </td>
  </tr>
 </table>
 <bottom>
</html>
