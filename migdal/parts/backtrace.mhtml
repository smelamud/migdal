<< @(#) $Id$ >>

<macro name='trace'>
 <backtrace_url url%!url='%url' target='$target' isbottom='*false'>
</macro>

<element name='backtrace_url' params='url,target,isbottom'
         defaults="isbottom='*true'">
<parse_url url='$url'>
<if what="$basename=='archive.php'">
 <trace url='index.php'>
 <assign name='_name' value='Архив'>
<elif what="$basename=='index.php'">
 <notenglish>
  <assign name='_name' value='Главная'>
 <else>
  <assign name='_name' value='Home'>
 </notenglish>
</if>
<if what='!$isbottom'>
 <at href='$url' target='$target'>$_name</at>&sp;&gt;&sp;
</if>
</element>

<element name='backtrace'>
<iterate_redirs name='redirs'>
<outer>
 <div class='return'>
  <for>
   <isfirst what='$redirs'>
    <inner>
    <backtrace_url url='$.URI' target='$target'>
   </isfirst>
   <islast what='$redirs'>
    </inner>
    $.Name
   <else>
    <at href='$.URI' target='$target'>
     <ife what='$.Name'>
      <notenglish>Главная<else>Home</notenglish>
     <else>
      $.Name</ife></at>&sp;&gt;
   </islast>
  </for>
 </div>
</outer>
</element>
