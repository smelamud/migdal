<< @(#) $Id$ >>
<< Based-on: demo/parts/postings.mhtml 1.6 >>

<element name='batcher_postings' params='value,list,topic,grp'>
<grpdata>
<grpitemtitle>
<table width=100% class='batcher'>
 <form method=get action='$~'>
  <hiddenget remove='mp'>
  <tr>
   <td align=left><table><tr valign=bottom><td>
    <logged>
     <if what='$g.Valid'>
      <a href='postingedit.php?topic_id=$topic&grp=$grp&redir=$_'
         class='add'>Добавить $grpitemtitle</a>
     <else>
      <a href='postingedit.php?topic_id=$topic&grp=*GRP_NEWS&redir=$_'
         class='add'>Добавить новость</a>
      </td><td width=10></td><td>
      <a href='postingedit.php?topic_id=$topic&grp=*GRP_ARTICLES&redir=$_'
         class='add'>Добавить статью</a>
     </if>
    </logged>
   </td></tr></table></td>
   <td align=right><table><tr valign=center>
    <td><input type=submit value='Показывать'></td>
    <td>по</td>
    <td>
     <select_portion name='mp' value='$value' vals='10 15 20 25 30 35 40'>
    </td>
    <td>из $list.Size сообщений</td>
    <if what='$list.Size>$list.Limit'>
     <form method=post action='actions/goto.php'>
      <hidden name='redir' value='$-'>
      <hidden name='size' value='$list.Size'>
      <td align=right width=32>
       <ifnzero what='$list.Offset'>
	<a href="$[offset='$list.PrevOffset']" title='Предыдущие'>
	 <img src='pics/left.gif' border=0></a>
       </ifzero>
      </td>
      <td align=right>
       <edit name='value' value='$list.BeginValue' size=2 maxlength=5>
      </td>
      <td align=center>-</td>
      <td align=right>
       $list.EndValue
      </td>
      <td align=left width=32>
       <if what='$list.EndValue<$list.Size'>
	<a href="$[offset='$list.NextOffset']" title='Следующие'>
	 <img src='pics/right.gif' border=0></a>
       </if>
      </td>
     </form>
    </if>
   </tr></table></td>
  </tr>
 </form>
</table>
</element>

<element name='Postings'>
<iterate_postinglist grp='$grp' topic='$topic' limit='$limit' offset='$offset'
                     sort='*SORT_PSENT'>
<if what='$$userId>0 || $;Count!=0'>
 <batcher_postings value='$limit' list='$;' topic='$topic' grp='$grp'>
 <table>
  <error id='*EMH_NO_MESSAGE' text='Такого сообщения не существует'>
  <error id='*EMH_NO_MODERATE' text='Вы не модератор'>
 </table>
 <for>
  <posting posting='$.' grp='$grp' topic='$topic'>
 </for>
 <ifnzero what='$;Count'>
  <batcher_postings value='$limit' list='$;' topic='$topic' grp='$grp'>
 </ifnzero>
</if>
</element>
