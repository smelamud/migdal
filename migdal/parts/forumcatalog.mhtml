<< @(#) $Id$ >>
<< Based-on: migdal/parts/postings.mhtml 1.23 >>

<element name='batcher_forumcatalog' params='value,list,topic'>
<table width=100% class='batcher'><tr valign=bottom>
 <td align=right><table><tr valign=center>
  <form method=get action='$~'>
   <hiddenget remove='fcp'>
   <td><input type=submit value='Показывать'></td>
   <td>по</td>
   <td>
    <select_portion name='fcp' value='$value' vals='10 15 20 25 30 35 40'>
   </td>
   <td><bymessages value='$value'></td>
  </form>
  <spin list='$list'>
 </tr></table></td>
</tr></table>
</element>

<element name='ForumCatalog'>
<grps>
<iterate_postinglist grp='*GRP_DISCUSS' topic='$topic' limit='$limit'
                     offset='$offset' sort='*SORT_ACTIVITY'
		     withanswers='*true'>
<if what='$$userId>0 || $;Count!=0'>
 <batcher_forumcatalog value='$limit' list='$;' topic='$topic' grp='*GRP_ALL'>
 <table>
  <error id='*EMH_NO_MESSAGE' text='Такого сообщения не существует'>
  <error id='*EMH_NO_MODERATE' text='Вы не модератор'>
 </table>
 <table width=100% class='catalog'>
  <tr>
   <if what='$topic<0'>
    <th>Раздел</th>
   </if>
   <th>Тема</th><th colspan=2>Начало / Последнее сообщение</th>
   <th class='answer'>Ответы</th>
  </tr>
  <for>
   <if what='$;isOdd'><tr class='odd'><else><tr></if>
    <if what='$topic<0'>
     <td class='topic' rowspan=2>
      <a href='forumcatalog.php?redirid=$_&topic_id=$.TopicId'
	 class='topic' title='$.TopicDescription'>$.TopicName</a>
     </td>
    </if>
    <td class='subject' rowspan=2>
     <a href='forum.php?redirid=$_&msgid=$.Id'>$.SubjectDesc</a>
    </td>
    <td>
     <if what='$.isRebe'>
      <span class='rebe'>
     </if>
     <senderlink message='$.'>
     <if what='$.isRebe'>
      </span>
     </if>
    </td>
    <td><sentview date='$.Sent'></td>
    <td class='answer' rowspan=2>
     <biff time='$.LastAnswer'>
     <a href='forum.php?redirid=$_&msgid=$.Id'>$.AnswerCount</a>
    </td>
   </tr>
   <if what='$;isOdd'><tr class='odd'><else><tr></if>
    <ifnzero what='$.LastAnswer'>
     <zone>
      <forum_answer_author up='$.MessageId' sent='$.LastAnswer'>
      <td>
       <if what='$.isRebe'>
	<span class='rebe'>
       </if>
       <senderlink message='$,'>
       <if what='$.isRebe'>
	</span>
       </if>
      </td>
     </zone>
     <td>
      <sentview date='$.LastAnswer'>
     </td>
    <else>
     <td>&nbsp;</td><td>&nbsp;</td>
    </ifnzero>
   </tr>
  </for>
 </table>
 <ifnzero what='$;Count'>
  <batcher_forumcatalog value='$limit' list='$;' topic='$topic'>
 </ifnzero>
<else>
 &nbsp;
</if>
</element>
