<< @(#) $Id$ >>

<element name='batcher_forumcatalog' params='list,topic'>
<table width=100% class='batcher'><tr valign=bottom>
 <td align=left>
  <logged>
   <a href='postingedit.php?topic_id=$topic&root=general&grp=*GRP_FORUMS&redirid=$_'
      class='add'>Добавить мнение</a>
  <else>
   <span class='info'>
    <b>Хотите добавлять мнения?</b>
    <a href='/register.php?redirid=$_'>Зарегистрируйтесь!</a>
   </span>
  </logged>
 </td>
 <td><spin list='$list'></td>
</tr></table>
</element>

<element name='forumcatalog'>
<grps>
<iterate_postinglist grp='*GRP_DISCUSS' topic='$topic' limit='$limit'
                     offset='$offset' sort='*SORT_ACTIVITY'
		     withanswers='*GRP_NOT_FORUMS'>
<if what='$$userId>0 || $;Count!=0'>
 <batcher_forumcatalog list='$;' topic='$topic'>
 <table>
  <error id='*EMH_NO_MESSAGE' text='Такого сообщения не существует'>
  <error id='*EMH_NO_MODERATE' text='Вы не модератор'>
 </table>
 <table width=100% class='catalog'>
  <tr>
   <if what='$topic<0'>
    <th>Раздел</th>
   </if>
   <th>Тема</th><th colspan=2>Начало / Последнее сообщение</th><th>Ответы</th>
  </tr>
  <for>
   <if what='$;isOdd'><tr class='odd'><else><tr></if>
    <if what='$topic<0'>
     <td class='topic ninept' rowspan=2 align=center>
      <a href='forumcatalog.php?redirid=$_&topic_id=$.TopicId'
	 title='$.TopicDescription'>$.TopicName</a>
     </td>
    </if>
    <td class='subject ninept' rowspan=2>
     <biff time='$.Sent'>
     <a href='forum.php?redirid=$_&msgid=$.Id'>$.SubjectDesc</a>
    </td>
    <td class='eightpt'><senderlink message='$.'></td>
    <td class='eightpt'><sentview date='$.Sent'></td>
    <td class='ninept' rowspan=2 align=center>
     <biff time='$.LastAnswer' small='*true'>
     $.AnswerCount
    </td>
   </tr>
   <if what='$;isOdd'><tr class='odd'><else><tr></if>
    <ifnzero what='$.LastAnswer'>
     <zone>
      <forum_answer_author parent_id='$.MessageId' sent='$.LastAnswer'>
      <td class='eightpt'><senderlink message='$,'></td>
     </zone>
     <td class='eightpt'><sentview date='$.LastAnswer'></td>
    <else>
     <td>&nbsp;</td><td>&nbsp;</td>
    </ifnzero>
   </tr>
  </for>
 </table>
 <ifnzero what='$;Count'>
  <batcher_forumcatalog list='$;' topic='$topic'>
 </ifnzero>
<else>
 &nbsp;
</if>
</element>
