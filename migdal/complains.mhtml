<< @(#) $Id$ >>

<force_community>

<element name='batcher' params='value,list'>
<table width=100% class='batcher'><tr>
 <td align=left>
  <logged>
   <a href='complainedit.php?ident=normal&redirid=$_'
      class='add'>Добавить жалобу</a>
  <else>
   <span class='info'>
    <b>Хотите посылать жалобы?</b>
    <a href='/register.php?redirid=$_'>Зарегистрируйтесь!</a>
   </span>
  </logged>
 </td>
 <td align=right><table><tr valign=center>
  <form method=get action='$~'>
   <hiddenget remove='cp'>
   <td><input type=submit value='Показывать'></td>
   <td>по</td>
   <td>
    <select_portion name='cp' value='$value' vals='20 25 30 35 40 45 50'>
   </td>
   <td><bymessages value='$value'></td>
  </form>
  <spin list='$list'>
 </tr></table></td>
</tr></table>
</element>

<macro name='row'>
 <if what='$.isClosed'>
  <if what='!$closed'>
   <if what='$;isOdd'><tr class='odd split'><else><tr class='split'></if>
  <else>
   <if what='$;isOdd'><tr class='odd'><else><tr></if>
  </if>
 <else>
  <if what='$;isOdd'><tr class='activeodd'><else><tr class='active'></if>
 </if>
 <assign name='closed' value='$.isClosed'>
</macro>

<int name='offset'>
<pagetitle title='Жалобная книга'>

<html>
<preamble>
<body>
 <top ident='index'>
 <iterate_complainlist limit='$$userComplainPortion' offset='$offset'>
 <batcher value='$$userComplainPortion' list='$;'>
 <table width=100% class='catalog'>
  <tr valign=top>
   <th>No.</th><th>Прислано</th><th>Автор</th><th>Заголовок</th>
   <th>Рассматривает</th><th>Закрыто</th><th>Ответы</th>
  </tr>
 <assign name='closed' value='*true'>
 <for name='complain'>
  <row>
   <td align=right class='eightpt'>$.Id</td>
   <td class='eightpt'><sentview date='$.Sent'></td>
   <td class='eightpt'><senderlink message='$.'></td>
   <td class='subject ninept'>
    <a href='complainforum.php?compid=$.Id&redirid=$_'>$.Subject</a>
    <biff time='$.Sent'>
   </td>
   <if what='$.isAssigned'>
    <td class='eightpt'><senderlink message='$.RecipientInfo'></td>
   <else>
    <td align=center>-</td>
   </if>
   <if what='$.isClosed'>
    <td class='eightpt'><sentview date='$.Closed'></td>
   <else>
    <td align=center class='eightpt'>Нет</td>
   </if>
   <td class='ninept' align=center>
    <biff time='$.LastAnswer'>
    $.AnswerCount
   </td>
  </tr>
 </for>
 </table>
 <batcher value='$$userComplainPortion' list='$;'>
 <bottom>
</body>
</html>
