<< @(#) $Id$ >>

<int name='topic_id'>
<int name='offset'>
<int name='recursive'>

<element name='batcher' params='list'>
<table width=100% class='batcher'><tr valign=bottom>
 <td align=center><spin list='$list'></td>
</tr></table>
</element>

<element name='error_lines'>
<if what='$$err!=0'>
 <table>
  <error id='*EMH_NO_MESSAGE' text='Такого сообщения не существует'>
  <error id='*EMH_NO_MODERATE' text='Вы не модератор'>
  <error id='*EMR_NO_RENEW' text='Вы не модератор'>
  <error id='*EMR_NO_MESSAGE' text='Такого сообщения не существует'>
  <error id='*EMR_SQL' text='Ошибка базы данных при обновлении записи'>
  <error id='*EPD_NO_DELETE' text='Вы не модератор'>
  <error id='*EPD_POSTING_ABSENT' text='Такого сообщения не существует'>
 </table>
</if>
</element>

<element name='post' params='posting'>
<table class='posting' width=100%>
 <tr><td>
  <iterate_topic_hierarchy topic_id='$posting.TopicId' root='$`links`'>
  <span class='subject'>
   <a href='$[topic_id=$posting.TopicId]' title='$posting.TopicDescription'
      class='topic'><asp>
    <for>
     <if what='!$;isFirst'>&sp;::&sp;</if>
     $.Name
    </for>
   <asp></a>
  </span>
  // $posting.GrpTitle
 </td></tr>
 <tr><td>
  <a href='$posting.DetailsFile?$posting.DetailsId=$posting.Id&redirid=$_'>
   $posting.SubjectDesc</a>
  <ifne what='$posting.Ident'>
   [$posting.Ident=$posting.Id]
  <else>
   [$posting.Id]
  </ifne>
 </td></tr>
 <tr><td class='sent'>
  <sentview date='$posting.Sent'>&nbsp;
  <senderlink message='$posting'>
 </td></tr>
 <tr><td class='bottom'>
  <a href="postingedit.php?editid=$posting.Id&grp=*GRP_ALL&root=-1&full=1&redirid=$_"
     >Изменить</a>
  &nbsp;
  <if what='$posting.isDisabled'>
   <a href="actions/moderate.php?editid=$posting.MessageId&hide=0&okdir=$#-&faildir=$#-"
      >Разрешить&nbsp;показ</a>
  <else>
   <a href="actions/moderate.php?editid=$posting.MessageId&hide=1&okdir=$#-&faildir=$#-"
      >Запретить&nbsp;показ</a>
  </if>
  &nbsp;
  <a href='actions/shadow.php?postid=$posting.Id&okdir=$#-&faildir=$#-'
     >Тень<ifnzero what='$posting.Shadow'> (*)</ifnzero></a>
  &nbsp;
  <a href="actions/messagerenew.php?id=$posting.MessageId&okdir=$#-&faildir=$#-"
     >Осовременить</a>
  &nbsp;
  <a href="actions/postingdel.php?id=$posting.Id&okdir=$#-&faildir=$#-"
     >Удалить</a>
 </td></tr>
</table>
<p>
</element>

<grps>
<pagetitle title='Организатор сообщений'>

<html>
<preamble>
<body>
 <top ident='index'>
 <table class='ninept aframe' style='padding: 5px'>
  <tr><td colspan=2>
   <a href='topicorg.php?redirid=$_'>Организатор тем</a>
  </td></tr>
  <form action='postingorg.php'>
   <hidden name='redirid' value='$redirid'>
   <topicselect name='topic_id' value='$topic_id'>
   <tr><td>&nbsp;</td><td>
    <checkbox title='С подтемами' name='recursive' value='$recursive'>
   </td></tr>
   <formbuttons title='Просмотр' span=2>
  </form>
 </table>
 <table class='ninept cframe' width=100%><tr><td>
  <error_lines>
  <iterate_postinglist topic='$topic_id' limit=20 offset='$offset'
		       showshadows='*true' grp='*GRP_ALL'
		       recursive='$recursive'>
  <batcher list='$;'>
  <ifnzero what='$;Count'>
   <for>
    <post posting='$.'>
   </for>
   <batcher list='$;'>
  </ifnzero>
 </td></tr></table>
 <bottom>
</body>
</html>
