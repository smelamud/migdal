<< @(#) $Id$ >>
<< Based-on: demo/complainactionedit.mhtml 1.6 >>

<int name='typeid'>
<int name='editid'>
<html>
<head>
 <title>Мигдаль - Ответы на жалобы</title>
</head>
<body>
 <top ident='complains'>
 <complain_type_obj id='$typeid'>
 <form method=get action='$~'><table class='form'><tr>
  <hidden name='redir' value='$redir'>
  <th>&nbsp;</th>
  <td>Тип</td>
  <td><select name='typeid'>
   <iterate_complain_types>
   <for>
    <radio title='$.Name' value='$.Id' peervalue='$typeid'>
   </for>
  </select></td>
  <td class='buttons-nosplit'><input type=submit value='Просмотр'></td>
 </tr></table></form>
 <p>
 <table width=100%><tr valign=top>
  <td>
   <table class='topics' width=100%>
    <col width='0*'>
    <tbody class='names'>
     <iterate_complain_actionlist type='$typeid'>
     <for>
      <tr>
       <td>
	<if what='$editid==$.Id'>
	 <img src='$$style_topics_arrow' width=11 height=12>
	</if>
       </td>
       <td>
	<a href='$[err edittag editid=$.Id]'>$.Name</a>
	<if what='$editid==$.Id'>
	 &nbsp;
	 <a href='/actions/cadel.php?editid=$.Id&okdir=$_&faildir=$_'
	    class='edit'>Удалить</a>
	</if>
       </td>
      </tr>
     </for>
     <tr>
      <td>
       <ifzero what='$editid'>
	<img src='$$style_topics_arrow' width=11 height=12>
       </ifzero>
      </td>
      <td><a href='$[err edittag editid=0]' class='new'>Добавить</a></td>
     </tr>
    </tbody>
   </table>
  </td>
  <td>
   <complain_action_obj id='$editid'>
   <setup>
   <if what='$editid'>
    <formtable title='Изменить ответ на жалобу'>
   <else>
    <formtable title='Добавить ответ на жалобу'>
   </if>
   <form method=post action='actions/camod.php'>
    <hidden name='edittag' value=2>
    <hidden name='redir' value='$redir'>
    <hidden name='okdir' value='$-'>
    <hidden name='faildir' value='$-'>
    <hidden name='type_id' value='$typeid'>
    <hidden name='editid' value='$editid'>
    <table>
     <starinfo>
     <error id='*ECAM_NO_EDIT' text='Вы не администратор'>
     <error id='*ECAD_NO_EDIT' text='Вы не администратор'>
     <error id='*ECAD_NO_ACTION' text='Такого ответа на жалобу не существует'>
     <error id='*ECAM_NO_TYPE' text='Такого типа жалобы не существует'>
     <error id='*ECAM_STORE_SQL' color=magenta
	    text='Ошибка базы данных при обновлении записи'>
     <error id='*ECAD_DELETE_SQL' color=magenta
	    text='Ошибка базы данных при удалении записи'>
    </table>
    <table>
     <error id='*ECAM_NO_SCRIPT' text='Такого скрипта не существует' span=2>
     <error id='*ECAM_ILLEGAL_SCRIPT' span=2
	    text='Этот скрипт нельзя прикреплять к такому типу жалобы'>
     <tr>
      <td><select name='script_id'>
       <iterate_complain_scriptlist ident='$type.Ident'>
       <radio title='-- Ничего не делать --' value=0 peervalue='$,ScriptId'>
       <for>
	<radio title='$.Name' value='$.Id' peervalue='$,ScriptId'>
       </for>
      </select></td>
      </td>
      <td>
       <checkbox name='automatic' value='$,isAutomatic'
		 title='Автоматически'>
      </td>
     </tr>
    </table>
    <table>
     <error id='*ECAM_NAME_ABSENT' text='Укажите заголовок ответа' span=2>
     <edit_line name='name' value='$,Name' title='Заголовок' size=40
		maxlength=70 mandatory='*true'>
     <error id='*ECAM_TEXT_ABSENT' span=2
	    text='Напишите хотя бы пару строчек в теле ответа'>
     <editor_line name='text' body='$,Text' title='Текст' span=2
		  mandatory='*true'>
    <if what='$editid'>
     <formbuttons title='Изменить' span=3>
    <else>
     <formbuttons title='Добавить' span=3>
    </if>
    </table>
   </form>
   </formtable>
  </td>
 </tr></table>
 <bottom>
</body>
</html>
