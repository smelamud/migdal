# Makefile for Migdal website

# @(#) $Id$

OBJECTS = article.php article-times.php chat.php chatboard.php chatbottom.php \
          chatconsole.php chattop.php chattune.php chatusers.php \
	  complainactionedit.php complainanswer.php complainedit.php \
	  complainforum.php complains.php forum.php forumansweredit.php \
	  forumcatalog.php gallery.php index.php limedit.php liminsert.php \
	  postingedit.php rating.php register.php stotext-help-subs.php \
	  stotext-help-types.php style.php taglit.php taglit-user.php \
	  times.php times-reorder.php topicedit.php topicorg.php useredit.php \
	  userfin.php userinfo.php userinfo-panel.php userok.php users.php
	  
%.php: %.mhtml ../miparser ../macros.mhtml macros.mhtml
	../miparser -M ../macros.mhtml -M macros.mhtml $< > $@

all: $(OBJECTS)
	(cd grp; $(MAKE) all)
	(cd parts; $(MAKE) all)
	(cd styles; $(MAKE) all)
	(cd mailings; $(MAKE) all)

Makefile: Makefile.in ../conf/migdal.conf
	../confmake $^ > Makefile

dbinfo:
	mysqldump -u $(dbUser) --password=$(dbPassword) $(dbName) \
		ratings --no-create-info > migdal.db

clean:
	-rm $(OBJECTS)
	(cd grp; $(MAKE) clean)
	(cd parts; $(MAKE) clean)
	(cd styles; $(MAKE) clean)
	(cd mailings; $(MAKE) clean)
