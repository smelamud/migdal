# Makefile for Migdal website

# @(#) $Id$

OBJECTS = article.php article-times.php book.php book-chapter.php \
	  chat.php chatboard.php chatbottom.php chatconsole.php \
	  chattop.php chattune.php chatusers.php complainactionedit.php \
	  complainanswer.php complainedit.php complainforum.php complains.php \
	  forum.php forumansweredit.php forumcatalog.php gallery.php \
	  horisontedit.php index.php jcc.php journal.php kaitana.php \
	  kaitana-main.php limedit.php liminsert.php links.php methodics.php \
	  migdal.php migdal-news.php posting.php postingedit.php \
	  postingorg.php rating.php register.php reorder.php \
	  stotext-help-subs.php stotext-help-types.php style.php taglit.php \
	  taglit-user.php times.php tips.php topicdel.php topicedit.php \
	  topiclinkadd.php topicorg.php useredit.php userfin.php userinfo.php \
	  userinfo-panel.php userlost.php userok.php userrepair.php users.php \
	  veterans.php veterans-user.php
	  
%.php: %.mhtml ../miparser ../macros.mhtml macros.mhtml
	../miparser -M ../macros.mhtml -M macros.mhtml $< > $@

all: $(OBJECTS)
	(cd grp; $(MAKE) all)
	(cd parts; $(MAKE) all)
	(cd styles; $(MAKE) all)
	(cd mailings; $(MAKE) all)

Makefile: Makefile.in ../conf/migdal.conf
	../confmake $^ > Makefile

dbinfo:
	mysqldump -u $(dbUser) --password=$(dbPassword) $(dbName) \
		ratings --no-create-info > migdal.db

clean:
	-rm $(OBJECTS)
	(cd grp; $(MAKE) clean)
	(cd parts; $(MAKE) clean)
	(cd styles; $(MAKE) clean)
	(cd mailings; $(MAKE) clean)
