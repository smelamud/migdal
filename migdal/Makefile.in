# Makefile for Migdal website

# @(#) $Id$

OBJECTS = article.php chat.php chatboard.php chatbottom.php chattop.php \
	  chattune.php complainactionedit.php complainanswer.php \
	  complainedit.php complainforum.php complains.php forum.php \
	  forumansweredit.php forumcatalog.php gallery.php index.php \
	  limedit.php liminsert.php menuedit.php postingedit.php postings.php \
	  register.php style.php topicedit.php useredit.php userfin.php \
	  userinfo.php userinfo-panel.php userok.php users.php
	  
%.php: %.mhtml ../miparser ../macros.mhtml macros.mhtml
	../miparser -M ../macros.mhtml -M macros.mhtml $< > $@

all: $(OBJECTS)
	(cd parts; $(MAKE) all)
	(cd styles; $(MAKE) all)

Makefile: Makefile.in ../conf/migdal.conf
	../confmake $^ > Makefile

dbinfo:
	mysqldump -u $(dbUser) --password=$(dbPassword) $(dbName) \
		menu ratings --no-create-info > migdal.db

clean:
	-rm $(OBJECTS)
	(cd parts; $(MAKE) clean)
	(cd styles; $(MAKE) clean)
