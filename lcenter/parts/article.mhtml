<< @(#) $Id$ >>

<element name='article_controls'>
<iswrite what='$posting'>
 <notprint>
  <p class='ninept' style='clear: both'>
   <a href="/postingedit.php?editid=$posting.Id&topic_id=$posting.TopicId&grp=$posting.Grp&redirid=$_"
      >Изменить</a>
   &nbsp;
   <a href="/limedit.php?postid=$posting.Id&redirid=$_"
      >Список иллюстраций</a>
  </p>
 </notprint>
</iswrite>
</element>

<macro name='isplaced'>
<if what='$par->isPlaced(%place)'>
</macro>

<macro name='/isplaced'>
</if>
</macro>

<macro name='notplaced'>
<if what='!$par->isPlaced(%place)'>
</macro>

<macro name='/notplaced'>
</if>
</macro>

<element name='pic' params='posting,par,drop_left,static'
                    defaults="static='*false'">
<image_placements>
<if what='$drop_left'>
 <assign name='clear' value=' style="clear: left"'>
<else>
 <ifnzero what='$par.ImageId'>
  <isplaced place='IPL_LEFT'>
   <assign name='clear' value=' style="clear: left"'>
  </isplaced>
  <isplaced place='IPL_HCENTER'>
   <assign name='clear' value=''>
  </isplaced>
  <isplaced place='IPL_RIGHT'>
   <assign name='clear' value=' style="clear: right"'>
  </isplaced>
 <else>
  <assign name='clear' value=''>
 </ifnzero>
</if>
<ifnzero what='$par.ImageId'>
 <notplaced place='IPL_TOP'>
  </p>
 </notplaced>
 <isplaced place='IPL_BOTTOM'>
  <p$clear>
 </isplaced>
 <isplaced place='IPL_VCENTER'>
  <isplaced place='IPL_LEFT'>
   <table$clear width='100%'><tr><td align='left'>
  </isplaced>
  <isplaced place='IPL_HCENTER'>
   <table$clear width='100%'><tr><td align='center'>
  </isplaced>
  <isplaced place='IPL_RIGHT'>
   <table$clear width='100%'><tr><td align='right'>
  </isplaced>
 </isplaced>
  <isplaced place='IPL_LEFT'>
   <table align='left'>
  </isplaced>
  <isplaced place='IPL_HCENTER'>
   <table>
  </isplaced>
  <isplaced place='IPL_RIGHT'>
   <table align='right'>
  </isplaced>
  <notprint>
   <iswrite what='$posting'>
    <tr><td align='center'>
     <a href='/liminsert.php?postid=$posting.Id&par=$par.Number&redirid=$_'
	class='eightpt'>Картинка</a>
    </td></tr>
   </iswrite>
  </notprint>
   <tr><td align='center'>
    <image_linked_tag id='$par.ImageId' enlarge='$par.hasLargeImage'
                      static='$static'>
   </td></tr>
   <ifne what='$par.Title'>
    <tr><td class='imagetitle'>$par.HTMLTitle</td></tr>
   </ifne>
  </table>
 <isplaced place='IPL_VCENTER'>
  </td></tr></table>
 </isplaced>
 <isplaced place='IPL_TOP'>
  </p>
 </isplaced>
 <notplaced place='IPL_BOTTOM'>
  <p$clear>
 </notplaced>
<else>
 </p>
 <notprint>
  <iswrite what='$posting'>
   <p$clear>
   <a href='/liminsert.php?postid=$posting.Id&par=$par.Number&redirid=$_'
      class='eightpt'>Картинка</a>
   </p>
  </iswrite>
 </notprint>
 <p$clear>
</ifnzero>
</element>

<element name='footnotes' params='&source'>
<iterate_footnotes source='$source'>
<ifnzero what='$;Count'><p>
 <hr class='notes' align='left'>
 <for>
  <a href='#_ref$.No'>
  <if what='$.isNumbered'>
   <sup>$.No</sup><asp>
  <else>
   $.Term<asp>
  </if>
  <asp></a> ---
  <a name='_note$.No'></a>$.HTMLBody<br>
 </for>
</p></ifnzero>
</element>

<text_formats>

<element name='article'>
<if what='$posting.LargeFormat==*TF_PRE'><pre></if>
<assign name='note_base'
        value!="$note_base_var!='' ? $GLOBALS[$note_base_var] : 1">
<iterate_posting_paragraphs name='list' posting='$posting'
                            note_base='$note_base'>
<p>
<for>
 <pic posting='$posting' par='$.' drop_left='$.isDropLeft' static='$static'>
 $.HTMLBody
</for>
</p>
<if what='$posting.LargeFormat==*TF_PRE'></pre></if>
<if what='$withvote'>
 <vote_frame id='$posting.Id' color='$$style_cframe_back'
	     image='$$style_cframe_back_pic'>
</if>
<footnotes source='$;'>
<ifne what='$note_base_var'>
 <?php $GLOBALS[$note_base_var]=$list->getNoteOffset(); ?>
</ifne>
</element>

<element name='article_full'>
<ifnzero what='$posting.ImageSet'>
 <table align='left' class='pic'>
  <tr><td>
   <image_linked_tag id='$posting.ImageId' enlarge='$posting.hasLargeImage'>
  </td></tr>
  <ifne what='$posting.Title'>
   <tr><td>$posting.HTMLTitle</td></tr>
  </ifne>
 </table>
</ifnzero>
$posting.HTMLBody
<article posting='$posting'>
<ifne what='$posting.Source'>
 <div class='source' align=right>$posting.HTMLSource</div>
</ifne>
</element>
